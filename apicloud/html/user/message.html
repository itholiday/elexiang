<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport"
          content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
    <meta name="format-detection" content="telephone=no"/>
    <title>e乐享</title>
    <link rel="stylesheet" type="text/css" href="../../css/aui.css"/>
    <style>
        .as {
            position: absolute;
            top: 1rem;
            right: 0.75rem;
            color: #1CC664
        }
    </style>
</head>
<body>
<div class="aui-card-list">
    <div class="aui-card-list-content">
        <script id="sx-list" type="text/x-dot-template">
            {{? it.status==1 }}
            {{ for(var i=0,len=it.data.length; i < len; i++) { }}
            <li class="aui-list-item aui-list-item-middle" tapmode data-data='{{= JSON.stringify(it.data[i]) }}' onclick="view(this,'{{= it.data[i].time }}')">
                <div class="aui-media-list-item-inner">
                    <div class="aui-list-item-inner">
                        <div class="aui-list-item-text">
                            <div class="aui-list-item-title aui-font-size-14">
                                {{= it.data[i].content }}
                            </div>
                        </div>
                        <div class="aui-list-item-text">
                            {{= it.data[i].time }}
                        </div>
                    </div>
                </div>
            </li>
            {{ } }}
            {{?}}
        </script>



        <ul class="aui-list aui-media-list" id="sx-view"><div id="jiazai"><img style="width: auto" src="../../image/loading_more.gif" /></div></ul>
    </div>
</div>
</body>
<script type="text/javascript" src="../../script/api.js"></script>
<script type="text/javascript" src="../../script/doT.js"></script>
<script type="text/javascript" src="../../script/zepto.min.js"></script>
<script type="text/javascript" src="../../script/app.js"></script>
<script type="text/javascript">
    apiready = function () {
        _shangla(function () {
            _lists({
                url: 'member/get_user_message',
                page: 1,
                loading: 1,
                data:{type:api.pageParam['type']}
            });
        })
        // 监听滚动
        api.addEventListener({
            name: 'scrolltobottom',
            extra: {
                threshold: threshold //设置距离底部多少距离时触发，默认值为0，数字类型
            }
        }, function (ret, err) {
            if (heigutgao == 1) {// heigutgao=1开启执行 0停止执行   防止连续滚动，等加载数据之后在进行滚动。
                pagenum += 1;
                _lists({
                    url: 'member/get_user_message',
                    page: pagenum,
                    data:{type:api.pageParam['type']}
                });
            }
        });
    }

    function baohan(text) {
        return text.indexOf("-");
    }

    function view(thiss, title) {
        var data = $api.attr(thiss, 'data-data');
        if (data) {
            data = eval('(' + data + ')');
            var json = {};
            var json1 = data;
            var json2 = {
                url: 'aboutView',
                title: title
            };
            json = eval('(' + (JSON.stringify(json1) + JSON.stringify(json2)).replace(/}{/, ',') + ')');
            data = json;
        }
        _url(data)
    }
</script>
</html>
